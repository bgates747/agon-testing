   10 REM Sample app to illustrate Pingo 3D on Agon
20 model_vertices%=60
30 model_indexes%=300
   40 VDU 17, 4+128 : REM SET TEXT BACKGROUND COLOR TO DARK BLUE
   50 VDU 18, 0, 4+128 : REM SET GFX BACKGROUND COLOR TO DARK BLUE
   60 CLS
   70 REM --== INITIALIZATION ==--
   80 PRINT "Reading vertices"
   90 total_coords%=model_vertices%*3
  100 max_abs=-99999
  110 DIM vertices(total_coords%)
  120 FOR i%=0 TO total_coords%-1
  130   READ coord
  140   vertices(i%)=coord
  150   a=ABS(coord)
  160   IF a>max_abs THEN max_abs=a
  170 NEXT i%
  180 factor=32767.0/max_abs
  190 PRINT "Max absolute value = ";max_abs
  200 PRINT "Factor = ";factor
  210 sid%=100: mid%=1: oid%=1: bmid1%=101: bmid2%=102
  220 PRINT "Creating control structure"
  230 scene_width%=320: scene_height%=240
  240 VDU 23,0, &A0, sid%; &49, 0, scene_width%; scene_height%; : REM Create Control Structure
  250 f=32767.0/256.0
  260 distx=0*f: disty=0*f: distz=-25*f
  270 VDU 23,0, &A0, sid%; &49, 25, distx; disty; distz; : REM Set Camera XYZ Translation Distances
  280 pi2=PI*2.0: f=32767.0/pi2
  290 anglex=0.0*f
  300 VDU 23,0, &A0, sid%; &49, 18, anglex; : REM Set Camera X Rotation Angle
  310 PRINT "Sending vertices using factor ";factor
  320 VDU 23,0, &A0, sid%; &49, 1, mid%; model_vertices%; : REM Define Mesh Vertices
  330 FOR i%=0 TO total_coords%-1
  340   val%=vertices(i%)*factor
  350   VDU val%;
  360   T%=TIME
  370   IF TIME-T%<1 GOTO 370
  380 NEXT i%
  390 PRINT "Reading and sending vertex indexes"
  400 VDU 23,0, &A0, sid%; &49, 2, mid%; model_indexes%; : REM Set Mesh Vertex Indexes
  410 FOR i%=0 TO model_indexes%-1
  420   READ val%
  430   VDU val%;
  440   T%=TIME
  450   IF TIME-T%<1 GOTO 450
  460 NEXT i%
  470 PRINT "Sending texture coordinate indexes"
  480 VDU 23,0, &A0, sid%; &49, 3, mid%; 1; 32768; 32768; : REM Define Texture Coordinates
  490 VDU 23,0, &A0, sid%; &49, 4, mid%; model_indexes%; : REM Set Texture Coordinate Indexes
  500 FOR i%=0 TO model_indexes%-1
  510   VDU 0;
  520 NEXT i%
  530 PRINT "Creating texture bitmap"
  540 VDU 23, 27, 0, bmid1%: REM Create a bitmap for a texture
  550 PRINT "Setting texture pixel"
  560 VDU 23, 27, 1, 1; 1; &55, &AA, &FF, &C0 : REM Set a pixel in the bitmap
  570 PRINT "Create 3D object"
  580 VDU 23,0, &A0, sid%; &49, 5, oid%; mid%; bmid1%+64000; : REM Create Object
  590 PRINT "Scale object"
  600 scale=6.0*256.0
  610 VDU 23, 0, &A0, sid%; &49, 9, oid%; scale; scale; scale; : REM Set Object XYZ Scale Factors
  620 PRINT "Create target bitmap"
  630 VDU 23, 27, 0, bmid2% : REM Select output bitmap
  640 VDU 23, 27, 2, scene_width%; scene_height%; &0000; &00C0; : REM Create solid color bitmap
  650 PRINT "Render 3D object"
  660 VDU 23, 0, &C3: REM Flip buffer
  670 rotatex=0.0: rotatey=0.0: rotatez=0.0
  680 factor=32767.0/pi2
  690 VDU 22, 136: REM 320x240x64 double-buffered
  700 VDU 23, 0, &C0, 0: REM Normal coordinates
  710 REM VDU 23, 0, &C0, 1: REM Abnormal coordinates
  720 VDU 17, 4+128 : REM SET TEXT BACKGROUND COLOR TO DARK BLUE
  730 VDU 18, 0, 4+128 : REM SET GFX BACKGROUND COLOR TO DARK BLUE
  740 inc=0.122718463
  750 REM --== MAIN LOOP ==--
  760 CLS
  770 incx=0.0:incy=0.0:incz=inc
  780 ON ERROR GOTO 1010 : REM used to prevent Escape key from stopping program
  790 A%=INKEY(0) : REM GET KEYBOARD INPUT FROM PLAYER.
  800 PRINT "keycode ";A%
  810 IF A%=21 THEN incz=-inc :REM RIGHT.
  820 IF A%=8 THEN incz=inc :REM LEFT.
  830 IF A%=10 THEN incy=inc :REM DOWN.
  840 IF A%=11 THEN incy=-inc :REM UP.
  850 PRINT "rotate x=";rotatex
  860 PRINT "rotate y=";rotatey
  870 PRINT "rotate z=";rotatez
  880 VDU 23, 0, &A0, sid%; &49, 38, bmid2%+64000; : REM Render To Bitmap
  890 VDU 23, 27, 3, 0; 0; : REM Display output bitmap
  900 VDU 23, 0, &C3: REM Flip buffer
  910 *FX 19
  920 rotatex=rotatex+incx: IF rotatex>=pi2 THEN rotatex=rotatex-pi2
  930 rotatey=rotatey+incy: IF rotatey>=pi2 THEN rotatey=rotatey-pi2
  940 rotatez=rotatez+incz: IF rotatez>=pi2 THEN rotatez=rotatez-pi2
  950 rx=rotatex*factor: ry=rotatey*factor: rz=rotatez*factor
  960 VDU 23, 0, &A0, sid%; &49, 13, oid%; rx; ry; rz; : REM Set Object XYZ Rotation Angles
  970 GOTO 760
 1000 REM -- EXIT PROGRAM --
 1010 VDU 22, 3: REM 640x240x64 single-buffered
 1020 VDU 23, 0, &C0, 0: REM Normal coordinates
 1030 REM VDU 23, 0, &C0, 1: REM Abnormal coordinates
 1040 VDU 17, 0+128 : REM SET TEXT BACKGROUND COLOR TO BLACK
 1050 VDU 18, 0, 0+128 : REM SET GFX BACKGROUND COLOR TO BLACK
 1060 CLS
 1070 END
 2000 REM -- VERTICES --
2010 DATA 0.26348284, 1.00000000, 0.78147656
2020 DATA 0.32156414, 1.00000000, 0.71684045
2030 DATA 0.48411819, 0.68194520, -0.90603113
2040 DATA 0.48513249, 0.60427064, -0.70783198
2050 DATA 0.44519752, 0.61701095, -0.94570869
2060 DATA 0.42617053, 0.67991626, -0.97132522
2070 DATA 0.32156417, 1.00000000, -0.71795434
2080 DATA 0.26000598, 1.00000000, -0.78147656
2090 DATA -0.32156417, 1.00000000, 0.71684045
2100 DATA -0.26348284, 1.00000000, 0.78147656
2110 DATA -0.48411819, 0.68194520, -0.90603113
2120 DATA -0.42617053, 0.67991620, -0.97132516
2130 DATA -0.44519752, 0.61701095, -0.94570869
2140 DATA -0.48513246, 0.60427064, -0.70783198
2150 DATA -0.26000598, 1.00000000, -0.78147656
2160 DATA -0.32156417, 1.00000000, -0.71795434
2170 DATA 0.42142227, 0.60511774, 0.90136057
2180 DATA 0.41941684, 0.68501335, 0.90414816
2190 DATA 0.36031774, 0.67991626, 0.97132528
2200 DATA 0.36366633, 0.58139360, 0.97466660
2210 DATA -0.36031774, 0.67991620, 0.97132522
2220 DATA -0.41941682, 0.68501335, 0.90414816
2230 DATA -0.42142227, 0.60511774, 0.90136057
2240 DATA -0.36366633, 0.58139360, 0.97466660
2250 DATA -0.24616720, 0.08606090, 0.72458351
2260 DATA -0.29405576, 0.06818560, 0.63028359
2270 DATA -0.23091280, 0.03621095, 0.64304137
2280 DATA 0.25849935, 0.36339158, 0.00000000
2290 DATA 0.33630264, 0.40160596, 0.03863262
2300 DATA -0.33630264, 0.40160596, 0.03863262
2310 DATA -0.25849935, 0.36339158, 0.00000000
2320 DATA 0.24616720, 0.08606091, 0.72458351
2330 DATA 0.23091280, 0.03621095, 0.64304137
2340 DATA 0.29405576, 0.06818560, 0.63028359
2350 DATA 0.21043643, 0.03772527, 0.38289717
2360 DATA 0.21197203, 0.07771635, 0.28686008
2370 DATA 0.27391607, 0.07056457, 0.37171450
2380 DATA -0.21043643, 0.03772527, 0.38289717
2390 DATA -0.27391604, 0.07056457, 0.37171450
2400 DATA -0.21197201, 0.07771635, 0.28686008
2410 DATA 0.05917179, 0.17802340, 0.18352899
2420 DATA 0.00282347, 0.23423289, 0.12708637
2430 DATA -0.00282348, 0.23423289, 0.12708637
2440 DATA -0.05917179, 0.17802340, 0.18352896
2450 DATA 0.00310079, 0.12181391, 0.23997156
2460 DATA 0.05917179, 0.17802340, 0.18352897
2470 DATA -0.05917179, 0.17802340, 0.18352896
2480 DATA -0.00310079, 0.12181391, 0.23997156
2490 DATA 0.00282348, 0.23423289, -0.94126958
2500 DATA 0.05917179, 0.17802340, -0.94223118
2510 DATA 0.00296194, 0.17803159, -0.99844903
2520 DATA -0.00282347, 0.23423289, -0.94126958
2530 DATA -0.00296193, 0.17803159, -0.99844903
2540 DATA -0.05917179, 0.17802340, -0.94223118
2550 DATA 0.00310079, 0.12181391, -0.94320941
2560 DATA 0.00296198, 0.17801520, -0.99844933
2570 DATA 0.05917179, 0.17802340, -0.94223118
2580 DATA -0.00310079, 0.12181391, -0.94320941
2590 DATA -0.05917179, 0.17802340, -0.94223118
2600 DATA -0.00296198, 0.17801520, -0.99844927
2610 REM
2620 REM -- INDEXES --
2630 DATA 4, 30, 12
2640 DATA 23, 31, 19
2650 DATA 29, 25, 22
2660 DATA 33, 28, 16
2670 DATA 29, 38, 25
2680 DATA 32, 37, 34
2690 DATA 56, 40, 45
2700 DATA 48, 42, 41
2710 DATA 36, 28, 33
2720 DATA 53, 46, 43
2730 DATA 52, 55, 59
2740 DATA 57, 44, 47
2750 DATA 15, 21, 8
2760 DATA 13, 29, 22
2770 DATA 16, 28, 3
2780 DATA 14, 5, 11
2790 DATA 17, 6, 1
2800 DATA 27, 39, 30
2810 DATA 2, 4, 5
2820 DATA 10, 12, 13
2830 DATA 16, 18, 19
2840 DATA 20, 22, 23
2850 DATA 24, 25, 26
2860 DATA 31, 32, 33
2870 DATA 34, 35, 36
2880 DATA 37, 38, 39
2890 DATA 48, 49, 50
2900 DATA 51, 52, 53
2910 DATA 54, 55, 56
2920 DATA 57, 58, 59
2930 DATA 14, 10, 15
2940 DATA 7, 2, 5
2950 DATA 12, 5, 4
2960 DATA 37, 35, 34
2970 DATA 16, 31, 33
2980 DATA 39, 29, 30
2990 DATA 35, 28, 36
3000 DATA 52, 48, 50
3010 DATA 54, 59, 55
3020 DATA 52, 58, 53
3030 DATA 50, 56, 55
3040 DATA 42, 53, 43
3050 DATA 41, 49, 48
3060 DATA 45, 54, 56
3070 DATA 57, 46, 58
3080 DATA 17, 0, 18
3090 DATA 9, 21, 20
3100 DATA 3, 17, 16
3110 DATA 13, 21, 10
3120 DATA 19, 20, 23
3130 DATA 32, 24, 26
3140 DATA 3, 27, 4
3150 DATA 13, 30, 29
3160 DATA 37, 25, 38
3170 DATA 34, 33, 32
3180 DATA 22, 24, 23
3190 DATA 9, 18, 0
3200 DATA 4, 27, 30
3210 DATA 23, 24, 31
3220 DATA 32, 26, 37
3230 DATA 56, 49, 40
3240 DATA 48, 51, 42
3250 DATA 53, 58, 46
3260 DATA 52, 50, 55
3270 DATA 57, 54, 44
3280 DATA 15, 10, 21
3290 DATA 14, 7, 5
3300 DATA 17, 2, 6
3310 DATA 27, 35, 39
3320 DATA 2, 3, 4
3330 DATA 10, 11, 12
3340 DATA 16, 17, 18
3350 DATA 20, 21, 22
3360 DATA 14, 11, 10
3370 DATA 7, 6, 2
3380 DATA 12, 11, 5
3390 DATA 37, 39, 35
3400 DATA 16, 19, 31
3410 DATA 39, 38, 29
3420 DATA 35, 27, 28
3430 DATA 52, 51, 48
3440 DATA 54, 57, 59
3450 DATA 52, 59, 58
3460 DATA 50, 49, 56
3470 DATA 42, 51, 53
3480 DATA 41, 40, 49
3490 DATA 45, 44, 54
3500 DATA 57, 47, 46
3510 DATA 17, 1, 0
3520 DATA 9, 8, 21
3530 DATA 3, 2, 17
3540 DATA 13, 22, 21
3550 DATA 19, 18, 20
3560 DATA 32, 31, 24
3570 DATA 3, 28, 27
3580 DATA 13, 12, 30
3590 DATA 37, 26, 25
3600 DATA 34, 36, 33
3610 DATA 22, 25, 24
3620 DATA 9, 20, 18
